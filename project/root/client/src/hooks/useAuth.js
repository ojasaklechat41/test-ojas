Custom hook for authentication handling